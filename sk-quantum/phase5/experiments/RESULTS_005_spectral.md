# Phase 5: ハミルトニアンと干渉 - 実験結果レポート

## 実施日
2024年12月

## 目的
計算グラフの隣接行列をハミルトニアンとして定義し、連続時間量子ウォーク U(t) = exp(-iAt) による干渉の有無を検証する。

**Phase 4 からの仮説**: 離散的置換群では複素構造が生じない。連続時間化によって複素構造が導入される可能性がある。

## 実装成果物

```
sk-quantum/phase5/
├── spectral/
│   ├── hamiltonian.py     # ✅ ハミルトニアン・量子ウォーク (13 tests)
│   ├── __init__.py
│   └── test_hamiltonian.py
└── experiments/
    └── RESULTS_005_spectral.md  # このファイル
```

---

## 1. 理論的背景

### 1.1 Phase 4 との関連

Phase 4 で確認したこと：
- **離散的置換行列**では複素構造 J² = -I は生成されない
- 置換行列の固有値は1の冪根（実数または複素共役ペア）
- 連続的位相 e^{iθ} が存在しない

### 1.2 連続時間量子ウォーク

**キーアイデア**: 離散→連続の極限で複素数が現れる

```
離散時間: P^n（置換行列の累乗）→ 実数のまま
連続時間: U(t) = exp(-iHt) → 複素指数関数
```

ハミルトニアン H = A（隣接行列）とすると：
- A は実対称行列 → 固有値 λₖ は実数
- U(t) = Σₖ exp(-iλₖt) |ψₖ⟩⟨ψₖ| → 複素係数
- 異なる固有値の干渉 → 確率の振動

---

## 2. 実験結果

### 2.1 テスト式の解析

| 式 | ノード数 | 辺数 | 干渉あり |
|----|----------|------|----------|
| `S (K a) (K b) c` | 5 | 5 | ✅ |
| `(K a b) (K c d)` | 4 | 4 | ✅ |
| `(K a b) (K c d) (K e f)` | 8 | 12 | ✅ |
| `S (K a) (K b) (S c d e)` | 11 | 21 | ✅ |

**結果: 全ての式で干渉パターンを検出**

### 2.2 スペクトル構造

| 式 | 固有値範囲 | スペクトルギャップ | 帯域幅 |
|----|------------|-------------------|--------|
| `S (K a) (K b) c` | [-2.14, 2.14] | 0.66 | 4.27 |
| `(K a b) (K c d)` | [-2.00, 2.00] | 2.00 | 4.00 |
| `(K a b) (K c d) (K e f)` | [-3.00, 3.00] | 1.00 | 6.00 |
| `S (K a) (K b) (S c d e)` | [-2.30, 4.08] | 0.60 | 6.38 |

**全ての固有値は実数**（実対称行列の性質）

### 2.3 干渉の定量評価

| 式 | 平均振動 | Total Variation |
|----|----------|-----------------|
| `S (K a) (K b) c` | 0.181 | 0.853 |
| `(K a b) (K c d)` | 0.227 | 0.852 |
| `(K a b) (K c d) (K e f)` | 0.130 | 0.735 |
| `S (K a) (K b) (S c d e)` | 0.072 | 0.582 |

- **平均振動**: 確率分布の時間方向の標準偏差（干渉の強さ）
- **Total Variation**: 量子分布と古典分布の差（0.5 × Σ|P_q - P_c|）

---

## 3. 量子 vs 古典の比較

### 3.1 振る舞いの違い

| 特性 | 古典ランダムウォーク | 連続時間量子ウォーク |
|------|---------------------|---------------------|
| 時間発展 | P^n（遷移行列の累乗） | exp(-iAt) |
| 確率分布 | 単調に定常分布へ収束 | 振動（干渉） |
| 拡散速度 | O(√n) | O(n)（弾道的拡散） |
| 数値構造 | 実数のまま | **複素数が現れる** |

### 3.2 量子エントロピー vs 古典エントロピー

| 式 | 量子 | 古典 |
|----|------|------|
| `S (K a) (K b) c` | 0.99 | 0.96 |
| `(K a b) (K c d)` | 0.81 | 1.00 |
| `(K a b) (K c d) (K e f)` | 1.21 | 2.00 |
| `S (K a) (K b) (S c d e)` | 2.22 | 3.30 |

**量子エントロピー < 古典エントロピー** in most cases
→ 量子ウォークは特定のノードに「局在」しやすい（干渉効果）

---

## 4. Phase 4 との整合性

### 4.1 離散 vs 連続の核心的違い

```python
# Phase 4: 離散時間（置換行列）
P = 置換行列
P^n は常に置換行列（実数、固有値は1の冪根）

# Phase 5: 連続時間（量子ウォーク）
A = 隣接行列（実対称）
U(t) = exp(-iAt) は複素ユニタリ行列
```

**検証**:
```
U(t=1) はユニタリ: True（全テスト式で確認）
```

### 4.2 複素数の「導入」vs「仮定」

| Phase | 複素数 | 導入方法 |
|-------|--------|----------|
| Phase 1A | 仮定 | J = iI を置く |
| Phase 1B | 仮定 | 接続を恣意的に選ぶ |
| Phase 2 | 仮定 | 計算式を選ぶ |
| Phase 4 | なし | 置換行列は実数閉 |
| **Phase 5** | **導入** | **exp(-iAt) で自然に現れる** |

**重要な違い**: Phase 5 では複素数を「仮定」していない。
`i` は exp(-iAt) の定義に含まれるが、これは「連続時間発展」の自然な帰結。

---

## 5. 結論

### 5.1 主要な発見

1. **連続時間量子ウォークで干渉が生じる**
   - 全てのテスト式で確認
   - 確率分布が時間に対して振動

2. **複素数は「連続時間化」によって導入される**
   - 離散時間（置換行列）: 複素構造なし
   - 連続時間 exp(-iAt): 複素指数関数が現れる

3. **計算グラフのスペクトルは実数**
   - 隣接行列 A は実対称
   - 固有値 λₖ は全て実数
   - しかし、exp(-iλₖt) は複素数

### 5.2 理論的解釈

```
┌─────────────────────────────────────────────────────────────────┐
│                    Phase 5 の発見                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  離散計算（Phase 4）:                                            │
│    置換行列 P ∈ O(n) ⊂ Sp(2n,ℝ)                                │
│    → 古典的（複素構造なし）                                      │
│                                                                  │
│  連続時間化（Phase 5）:                                          │
│    U(t) = exp(-iAt) ∈ U(n)                                      │
│    → 量子的（複素構造が現れる）                                  │
│                                                                  │
│  ★ 鍵となる操作: 「離散→連続」の極限                            │
│    これが古典↔量子の境界か？                                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 5.3 研究計画への影響

**仮説の更新**:

| 仮説 | Phase 4 | Phase 5 | 状態 |
|------|---------|---------|------|
| H1: 可逆計算は古典的 | 支持 | - | ✅ 確認（離散に限定） |
| H2: 干渉には非可換性が必要 | - | **要再検討** | Phase 7 |
| H5 (新): 連続時間化が量子性の鍵 | - | **示唆** | 継続検証 |

**新たな問い**:
- 「連続時間化」は量子構造の十分条件か？
- exp(-iAt) の `i` は「仮定」か「導出」か？
- 計算グラフのどの構造的特徴が干渉に寄与するか？

---

## 6. 今後の方向性

### 6.1 Phase 6 への示唆

- RCA（可逆セルオートマトン）でも同様に連続時間化すれば干渉が生じるか？
- 予測: **はい**（隣接行列があれば exp(-iAt) は定義可能）

### 6.2 Phase 7 への示唆

- 非可換性の役割は何か？
- Phase 5 では非可換性を検証していない
- 干渉と非可換性の関係を明らかにする必要

### 6.3 根本的な問い

> **「i」はどこから来るのか？**

exp(-iAt) の定義で `i` を使っているが、これは：
- **物理学的**: シュレーディンガー方程式から
- **数学的**: リー群の表現論から
- **計算論的**: ？？？

Phase 7 でこの問いを深掘りする必要がある。

---

## 付録: 実装詳細

### テスト結果
```
13 passed in 0.30s
```

### 主要なクラス

```python
ComputationHamiltonian  # 計算グラフ → 隣接行列
SpectralAnalysis        # スペクトル解析
ContinuousTimeQuantumWalk  # U(t) = exp(-iAt)
ClassicalRandomWalk     # 比較用古典ウォーク
InterferenceAnalysis    # 干渉検出
```

### 再現方法
```bash
cd sk-quantum/phase5/spectral
python3 -m pytest test_hamiltonian.py -v
python3 hamiltonian.py
```

