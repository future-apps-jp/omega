# Phase 4: 可逆計算の代数構造 - 実験結果レポート

## 実施日
2024年12月

## 目的
可逆論理ゲート（Toffoli, Fredkin）の代数構造を解析し、以下を検証する：
1. 生成される群の構造（置換群の部分群としての特徴）
2. シンプレクティック群 Sp(2n, ℝ) への埋め込み可能性
3. 複素構造 J² = -I の存在（非自明解の探索）
4. 古典 vs 量子の判定

## 実装成果物

```
sk-quantum/phase4/
├── reversible/
│   ├── gates.py           # ✅ 可逆論理ゲート (18 tests)
│   ├── group_analysis.py  # ✅ 群構造解析
│   ├── symplectic.py      # ✅ シンプレクティック解析
│   ├── __init__.py
│   └── test_gates.py      # ✅ テスト
└── experiments/
    ├── run_phase4_analysis.py  # ✅ 完全な実験スクリプト
    └── RESULTS_004_algebra.md  # このファイル
```

---

## 1. 可逆論理ゲートの基本性質

### 1.1 実装したゲート

| ゲート | ビット数 | 定義 | 行列サイズ |
|--------|----------|------|------------|
| NOT | 1 | x → ¬x | 2×2 |
| CNOT | 2 | (a,b) → (a, a⊕b) | 4×4 |
| Toffoli | 3 | (a,b,c) → (a,b, c⊕(a∧b)) | 8×8 |
| Fredkin | 3 | (a,b,c) → (a, swap(b,c) if a=1) | 8×8 |
| SWAP | 2 | (a,b) → (b,a) | 4×4 |

### 1.2 検証結果

| ゲート | 可逆性 | 自己逆 | 直交行列 | det = ±1 |
|--------|--------|--------|----------|----------|
| NOT | ✓ | ✓ | ✓ | ✓ |
| CNOT | ✓ | ✓ | ✓ | ✓ |
| Toffoli | ✓ | ✓ | ✓ | ✓ |
| Fredkin | ✓ | ✓ | ✓ | ✓ |
| SWAP | ✓ | ✓ | ✓ | ✓ |

**結論**: 全ての可逆論理ゲートは
- 可逆（全単射）
- 自己逆（g² = I）
- 直交行列（P^T P = I）
- 行列式 = ±1

---

## 2. 群構造解析

### 2.1 生成される群の位数

| 生成元 | 群の位数 | S_8 の位数 | 比率 |
|--------|----------|------------|------|
| Toffoli 単体 | 2 | 40,320 | 0.005% |
| Fredkin 単体 | 2 | 40,320 | 0.005% |
| Toffoli + Fredkin | 6 | 40,320 | 0.015% |

**注意**: 各ゲートが自己逆のため、単体では {I, G} の2元群しか生成しない。
計算万能性を示すには、異なるビット位置に作用する複数ゲートの組み合わせが必要。

### 2.2 パリティ構造

| 生成元 | 偶置換数 | 奇置換数 | 交代群 A_8 の部分群 |
|--------|----------|----------|---------------------|
| Toffoli | 1 | 1 | いいえ |
| Fredkin | 1 | 1 | いいえ |

**結論**: Toffoli と Fredkin は奇置換を含む → 交代群には限定されない

---

## 3. J² = -I の探索

### 3.1 理論的背景

複素数構造が存在するためには、J² = -I を満たす演算子 J が必要。
- 量子力学では i（虚数単位）がこの役割を果たす
- J² = -I の固有値は ±i

### 3.2 検証結果

#### 単一の置換行列
```
候補数: 0
```
**理由**: 置換行列の固有値は1の冪根（λⁿ = 1）であり、±i にはならない。

#### 線形結合（複素係数）
```
J = iI → J² = -I ✓ (自明解)
```
これは複素数を「仮定」しており「導出」ではない。

### 3.3 置換行列の固有値

| 行列 | 固有値 |
|------|--------|
| I | {1} |
| Toffoli | {-1, 1} |
| Fredkin | {-1, 1} |

**結論**: 全ての固有値は実数。±i は現れない。

---

## 4. シンプレクティック埋め込み

### 4.1 埋め込み方法

置換行列 P (n×n) を 2n×2n のシンプレクティック空間に埋め込む：

```
M = [[P, 0], [0, P]]
```

### 4.2 シンプレクティック条件の検証

シンプレクティック形式: Ω = [[0, I], [-I, 0]]

条件: M^T Ω M = Ω

| 行列 | M^T Ω M = Ω |
|------|-------------|
| I | ✓ |
| Toffoli | ✓ |
| Fredkin | ✓ |

**結論**: 全ての置換行列は Sp(2n, ℝ) に埋め込み可能

### 4.3 理論的解釈

```
直交群 O(n) ⊂ シンプレクティック群 Sp(2n, ℝ)

埋め込み: P ∈ O(n) → [[P, 0], [0, P]] ∈ Sp(2n, ℝ)
```

これは**古典ハミルトン力学**の対称群への埋め込みであり、
**量子力学**のユニタリ群 U(n) とは異なる。

---

## 5. 複素構造との関係

### 5.1 標準複素構造

```
J = [[0, -I], [I, 0]]

J² = -I ✓
```

### 5.2 交換関係

埋め込まれた行列 [[P, 0], [0, P]] と J の交換子:

| 行列 | [M, J] = 0 |
|------|------------|
| I | ✓ |
| Toffoli | ✓ |
| Fredkin | ✓ |

**全要素が J と可換**

### 5.3 重要な注意

J と可換であることは、「量子的」を意味**しない**。

理由:
- [[P, 0], [0, P]] は「実数的」ブロック対角
- P は実直交行列であり、複素数的位相 e^{iθ} を持たない
- 離散的置換群には連続的位相が存在しない

---

## 6. 古典 vs 量子の判定

### 6.1 判定基準

| 基準 | 古典 | 量子 |
|------|------|------|
| 群の構造 | Sp(2n, ℝ) | U(n) |
| 固有値 | 実数 | 複素数（絶対値1） |
| J² = -I | 自明解のみ | 非自明解あり |
| 位相 | 離散 {0, π} | 連続 [0, 2π) |

### 6.2 判定結果

| 項目 | 結果 | 判定 |
|------|------|------|
| Sp(2n, ℝ) に埋め込み | ✓ | - |
| 全固有値が実数 | ✓ | 古典的 |
| J² = -I（非自明） | ✗ | 古典的 |
| 連続的位相 | ✗ | 古典的 |

**最終判定: 古典的**

---

## 7. 結論

### 7.1 主要な発見

1. **可逆論理ゲートは置換行列で表現される**
   - 全て直交行列（P^T P = I）
   - 全て自己逆（P² = I）

2. **シンプレクティック群に埋め込み可能**
   - O(n) ⊂ Sp(2n, ℝ) の標準的埋め込み
   - 古典ハミルトン力学と同型

3. **複素構造は生成されない**
   - J² = -I の非自明解は存在しない
   - 複素数は「仮定」でき「導出」できない

4. **離散性の限界**
   - 置換群は離散的
   - 連続的位相 e^{iθ} が存在しない
   - 干渉項 2Re(ψ₁*ψ₂) が定義できない

### 7.2 研究計画への影響

**仮説 H1 を支持**:
> 「可逆計算は古典的であり、Sp(2n, ℝ) に閉じる」

**次のステップ**:
- Phase 5: ハミルトニアン（隣接行列）のスペクトル解析
- 連続時間量子ウォークのアプローチで干渉を検証

### 7.3 学術的意義

この否定的結果は以下を確立する：
- 可逆性だけでは量子構造は生じない
- 古典的可逆計算と量子計算の間には明確な境界がある
- その境界は「離散 vs 連続」「実数 vs 複素数」にある

---

## 8. 実装詳細

### テスト結果
```
18 passed in 0.36s
```

### 使用ライブラリ
- NumPy: 行列計算
- SciPy: 行列の指数・対数
- pytest: テスト

### 再現方法
```bash
cd sk-quantum/phase4/reversible
python3 -m pytest test_gates.py -v

cd ../experiments
python3 run_phase4_analysis.py
```

---

## 付録: 数学的補足

### A. シンプレクティック群の定義

```
Sp(2n, ℝ) = { M ∈ GL(2n, ℝ) | M^T Ω M = Ω }

Ω = [[0, I_n], [-I_n, 0]]
```

### B. ユニタリ群との関係

```
U(n) ⊂ Sp(2n, ℝ)

埋め込み: U ∈ U(n) → [[Re(U), -Im(U)], [Im(U), Re(U)]] ∈ Sp(2n, ℝ)
```

置換行列 P は Im(P) = 0 なので、この埋め込みは単に [[P, 0], [0, P]] となる。
これは U(n) の「実数部分」であり、完全な U(n) ではない。

### C. なぜ ±i が現れないか

置換行列の特性多項式は整数係数。
固有値は代数的整数であり、1の冪根。
±i は4次の原始根だが、n ≤ 8 の置換では 4 | n でないと現れない。
しかし、3-bit 空間での置換（n = 8）でも、Toffoli/Fredkin の固有値は {-1, 1} のみ。

